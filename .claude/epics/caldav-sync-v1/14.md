---
name: Clean up plugin UI — remove debug commands, add production commands
status: open
created: 2026-02-12T00:23:37Z
updated: 2026-02-12T00:28:04Z
github: https://github.com/josecoelho/obsidian-tasks-caldav/issues/14
depends_on: [17]
parallel: true
conflicts_with: [17]
---

# Task: Clean up plugin UI — remove debug commands, add production commands

## Description
Clean up `main.ts` for production use. Remove all test/debug commands added during development and wire up proper sync commands. The current plugin has several debug commands (test-obsidian-tasks-access, test-task-manager, dump-caldav-requests) that should not ship.

## Acceptance Criteria
- [ ] Debug commands removed: test-obsidian-tasks-access, test-task-manager, dump-caldav-requests, sync-dry-run, add-sync-tag-to-mapped-tasks
- [ ] Ribbon icon triggers actual sync (not a test)
- [ ] "Sync Now" command works with the new sync engine
- [ ] "View Sync Status" command shows: last sync time, task count, pending conflicts
- [ ] Auto-sync interval starts on plugin load, restarts when settings change, stops on unload
- [ ] Connection test button in settings works with CalDAVClientDirect
- [ ] `requestDumper.ts` import removed from main.ts (keep file for dev use)

## Technical Details
- **Modified files:**
  - `main.ts` — remove debug commands, wire production commands to new SyncEngine
- **Key changes:**
  - Replace `inject-task-ids` and `validate-task-ids` commands with `caldav-sync-now` and `caldav-view-status`
  - Ribbon icon onClick → call sync engine
  - Auto-sync: `registerInterval(window.setInterval(...))` with configurable interval from settings
  - Status display: read from SyncStorage state + mapping count

## Dependencies
- [ ] Task 003 (new sync engine) — commands need to call the new SyncEngine

## Effort Estimate
- Size: S
- Hours: 2-4
- Parallel: true (can start after 003, parallelizable with 005/006)
